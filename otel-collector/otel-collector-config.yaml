receivers:
  otlp:
    protocols:
      http:
        endpoint: "0.0.0.0:4318"

connectors:
  routing:
    default_pipelines: [traces]
    table:
      - context: request
        condition: request["X-Tenant"] == "debug"
        pipelines: [traces/other]

exporters:
  otlp/elastic:
    endpoint: ${ELASTIC_ENDPOINT}
    headers:
      Authorization: "ApiKey ${ELASTIC_API_KEY}"

  debug:
    verbosity: detailed

processors:
  transform/logs-streams:
    log_statements:
      - context: resource
        statements:
          - set(attributes["elasticsearch.index"], "logs")

service:
  pipelines:
    traces:
      receivers: [otlp]
      exporters: [otlp/elastic] 
    traces/other:
      receivers: [otlp]
      exporters: [debug] 
    logs:
      receivers: [otlp]
      processors: [transform/logs-streams]
      exporters: [otlp/elastic] 
    metrics:
      receivers: [otlp]
      exporters: [otlp/elastic] 
